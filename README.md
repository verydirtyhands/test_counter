# Прогнозирование показателей счётчика

## Задача 

1. Сделать прогноз временного ряда на следующие сутки. 
2. Выбрать метрику, оценить результат прогноза. 
3. Выполнить поиск аномальных значений временного ряда.
4. Построить на одном графике: временной ряд, прогноз, аномальные точки. 

## Критерии оценки задания

- предобработка данных
- выбор метрики
- качество модели
- детекция аномалий
- вывод результата на графике

## Инструменты:
`Python==3.9.16`
`Pandas==1.5.3`
`sklearn==1.2.2`
`seaborn==0.12.2`
`matplotlib==3.6.3`
`keras==2.12`
`numpy==1.23.5`
`plotly==5.15.0`
`prophet==1.1.4`
`statsmodels==0.13.5`
`catboost==1.2`
`sktime==0.21.0`
`ydata-profiling==4.1.2`
`shap==0.40.0`

## Описание данных:

- counter_timestamp — время наблюдения с интервалом в 15 минут (с 2022-02-21 по 2022-03-23);
- counter_data — значения счётчика

## Описание итоговых файлов и папок:

### папка test_task :

- <a href='https://nbviewer.org/github/verydirtyhands/test_counter/blob/main/test_task/t1f.ipynb'>t1f.ipynb</a> - основной файл с выполненым тестовым заданием (ссылка на nbviewer)
- <a href='https://github.com/verydirtyhands/test_counter/test_task/performance_data.csv'>performance_data.csv</a> - данные предоставленные для выполнения задания
- <a>model_targ0.h5 - итоговая сохранённая модель (RNN)

### остальные файлы в репозитории :

- README.md - общее описание работы
- <a href='https://github.com/verydirtyhands/test_counter/docker.md'>docker.md</a> - инструкция по запуску проекта через docker
- <a href='https://github.com/verydirtyhands/test_counter/requirements.txt'>requirements.txt</a> - файл с описанием зависимостей
- docker-compose.yml и Dockerfile - инструкции по запуску окружения для Docker
- .gitignore - список с файлами не вошедшими в репозиторий

## Краткое описание проведённой работы:
<i> 
Проанализированы показатели счётчика за месяц .Проведён resample ,детекция аномалий ,проверка на стационарность ряда .Построена модель на основе Prothet , Catboost и рекуррентная нейронная сеть(LSTM) при помощи Keras для определения показателей счётчика через сутки(24ч) .</i>

## Выводы
<i>В процессе анализа и прогнозирования мы сгенерировали дополнительные признаки, такие как скользящее среднее, час дня, день недели, а также данные о значениях показателей в прошлом (от 1 суток до 4 суток назад).

Были рассмотрены различные модели для прогнозирования временного ряда, включая Prophet, RNN и CatBoost. По результатам экспериментов выявлено, что CatBoost продемонстрировал наилучшие результаты среди рассмотренных моделей. Метрика RMSE (квадратный корень из средней квадратичной ошибки) на тестовой выборке составила 1600 для CatBoost, в то время как наивная модель показала значительно худший результат, с RMSE 2900.

Это говорит о том, что CatBoost сумел эффективно извлечь информацию из предоставленных признаков и временных данных, что позволило ему делать более точные прогнозы. Включение дополнительных признаков, таких как скользящее среднее и данные о прошлых значениях, вероятно, способствовало улучшению производительности модели.

Исходя из результатов экспериментов и анализа, можно заключить, что для данного временного ряда CatBoost является наиболее подходящей моделью прогнозирования, позволяющей достичь относительно низкой ошибки прогноза и более точных результатов.</i>

## Рекомендации
<i>Для улучшения производительности модели рекомендуется собрать дополнительные данные. Ваша текущая выборка ограничена по временному периоду, и сбор данных за ещё 2 недели может значительно расширить ваш набор данных. Больший объем данных позволит модели выявить более сложные зависимости во временных рядах и создать более точный прогноз.

Рассмотрите возможность добавления дополнительных признаков, которые могут оказать положительное влияние на качество прогноза. Например, праздничные дни, сезонные факторы или другие внешние переменные могут быть важными для понимания временных колебаний и аномалий в данных.
</i>

---

#### Если проект не открывается или вы хотите посмотреть со всеми интерактивными ячейками(plotly,ydata-profiling), его можно открыть по ссылке: <a href='https://nbviewer.org/github/verydirtyhands/test_counter/blob/main/test_task/t1f.ipynb'>Модель для прогнозирование показателей счётчика</a>
